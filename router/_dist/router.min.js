class Route{constructor(t,e,s,i){this.path=t,this.htmlPath=e,this.JSPath=s,this.title=i||""}async getHtmlContent(t="/"){let e=t+this.htmlPath,s=await fetch(e);return s.text()}getFullJSPath(t="/"){return t+this.JSPath}}class Router{constructor(t,e,s=null,i="/"){if(!t||!(t instanceof HTMLElement))throw Error("entryDOM is required and must be a DOM element");if(!e||!(e instanceof Route))throw Error("notFoundRoute is required and must be an instance of Route");this.baseUrl=i.endsWith("/")?i:i+"/",this.routes=[],this.entry=t,this.notFoundRoute=e,this.loadingRoute=s,window.onpopstate=t=>this.handlePopState(t)}addRoute(t){this.routes.push(t)}getCurrentPath(){let t=window.location.pathname;return this.removeBaseUrl(t)}isPathActive(t){return this.getCurrentPath()===t}isRouteActive(t){return this.isPathActive(t.path)}async init(){let t=this.getCurrentPath();await this.navigateTo(t)}async navigateTo(t){this.loadingRoute&&(document.title=this.loadingRoute.title||"Loading...",this.entry.innerHTML=await this.loadingRoute.getHtmlContent(this.baseUrl));let e=this.routes.find(e=>e.path===t);e||(e=this.notFoundRoute),document.title=e.title||"Document",this.entry.innerHTML=await e.getHtmlContent(this.baseUrl);let s=document.getElementById("page_script");s&&s.remove();let i=document.createElement("script");i.src=e.getFullJSPath(this.baseUrl),i.id="page_script",document.body.appendChild(i);let a=this.prependBaseUrl(t);window.history.pushState({path:a},"",a)}handlePopState=t=>{let e=t.state?t.state.path:this.notFoundRoute.path;console.log(e),this.navigateTo(e)};prependBaseUrl(t){return"/"===this.baseUrl&&t.startsWith("/")?t:this.baseUrl+(t.startsWith("/")?t.slice(1):t)}removeBaseUrl(t){return"/"!==this.baseUrl&&t.startsWith(this.baseUrl)?t.slice(this.baseUrl.length-1):t}}export{Route,Router};